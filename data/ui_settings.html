<!DOCTYPE html>
<html>

<head>
  <title>UI Settings</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
  <h2>UI Creator</h2><br>
  <table class="inlineTable">
    <th><strong>Draw Queue:</strong></th>
    %UI_DRAW_QUEUE_TABLE%
    <tr>
      <td><button class="btn" onclick="openForm()"><strong>Add Element</strong></button></td>
    </tr>
  </table>
  <table class="inlineTable">
    <th><strong>Data:</strong></th>
    %UI_DATA_TABLE%
  </table>

  <br>

  <form action="/save_changes" , method="POST">
    <button type="submit" class="btn">Save Changes</button>
  </form>

  <hr>

  <div class="loginPopup">
    <div class="formPopup" id="popupForm">
      <form action="/new_element" method="POST" class="formContainer">
        <h2>New Element</h2>
        <table class="inlineTable">
          <tr>
            <td><label class="lab">Element Type</label></td>
            <td><select name=ui_element id="ui_element" onchange="checkUiAlert(event)">
                <option value="" selected disabled hidden>Choose here</option>
                %UI_ELEM_SELECT%
              </select></td>
          </tr>

          <tr class="formHiddenFields" id="data_type">
            <td><label class="lab">Element Data Type</label></td>
            <td><select name="data_arg" id="data_arg">
                <option value="" selected disabled hidden>Choose here</option>
                %UI_DATA_TYPE_SELECT%
              </select></td>
          </tr>

          <tr class="formHiddenFields" id="colour">
            <td><label class="lab">Element Colour</label></td>
            <td><select name="colour_arg" id="colour_arg" onchange="checkColourAlert(event)">
                <option value="" selected disabled hidden>Choose here</option>
                <option value="0">Solid Colour</option>
                <option value="1">Dynamic Colour</option>
              </select></td>
          </tr>

          <tr class="formHiddenFields" id="solid_color">
            <td><label class="lab">Solid Colour</label></td>
            <td><input type="color" name="solid_colour_arg" id="solid_colour_arg" value="#ffffff"></td>
          </tr>

          <tr class="formHiddenFields" id="dynamic_colour_data">
            <td><label class="lab">Dynamic Colour Data</label></td>
            <td><select name="colour_data_type" id="colour_data_type">
                <option value="" selected disabled hidden>Choose here</option>
                %UI_DATA_TYPE_SELECT%
              </select></td>
          </tr>

          <tr class="formHiddenFields" id="dynamic_colour_low_label">
            <td><label class="lab">Lowest Value Colour</label></td>
          </tr>
          <tr class="formHiddenFields" id="dynamic_colour_low">
            <td><input type="number" name="arg_low_data" id="arg_low_data" value="0"></td>
            <td><input type="color" name="arg_low_colour" id="arg_low_colour" value="#00ffff"></td>
          </tr>

          <tr class="formHiddenFields" id="dynamic_colour_high_label">
            <td><label class="lab">Highest Value Colour</label></td>
          </tr>
          <tr class="formHiddenFields" id="dynamic_colour_high">
            <td><input type="number" name="arg_high_data" id="arg_high_data" value="100"></td>
            <td><input type="color" name="arg_high_colour" id="arg_high_colour" value="#ff0000"></td>
          </tr>

          <tr>
            <td><button type="submit" class="btn">Create</button></td>
            <td><button type="button" class="btn cancel" onclick="closeForm()">Cancel</button></td>
          </tr>
        </table>
      </form>
    </div>
  </div>
  <script>
    function openForm() {
      document.getElementById("popupForm").style.display = "block";
    }
    function closeForm() {
      document.getElementById("popupForm").style.display = "none";
    }
    function checkUiAlert(evt) {
      // Hiding all hideable args
      var selects = document.getElementsByClassName("formHiddenFields");
      for (var i = 0, il = selects.length; i < il; i++) {
        selects[i].style.display = "none";
      }

      // Showing only the relevant args
      var arglist = ui_elems[evt.target.value];
      for (var arg = 0, arg_len = arglist.length; arg < arg_len; arg++) {
        switch (arglist[arg]) {
          case "0":
            document.getElementById("data_type").style.display = "table-row";
            break;
          case "1":
            document.getElementById("colour").style.display = "table-row";
            break;
          case "2":
            // TODO: Handle constants
            break;
        }
      }
    }

    // Switches colour type args on or off
    function checkColourAlert(evt) {
      if (evt.target.value == "0") {
        document.getElementById("solid_color").style.display = "table-row";

        document.getElementById("dynamic_colour_data").style.display = "none";
        document.getElementById("dynamic_colour_low_label").style.display = "none";
        document.getElementById("dynamic_colour_low").style.display = "none";
        document.getElementById("dynamic_colour_high_label").style.display = "none";
        document.getElementById("dynamic_colour_high").style.display = "none";
      } else if (evt.target.value == "1") {
        document.getElementById("dynamic_colour_data").style.display = "table-row";
        document.getElementById("dynamic_colour_low_label").style.display = "table-row";
        document.getElementById("dynamic_colour_low").style.display = "table-row";
        document.getElementById("dynamic_colour_high_label").style.display = "table-row";
        document.getElementById("dynamic_colour_high").style.display = "table-row";

        document.getElementById("solid_color").style.display = "none";
      }
    }

    // Stores all ui element types and args
    var ui_elems = {
      // "1": ["1"],
      // "2": ["0", "1"],
      %UI_ELEM_DATA%
    };
  </script>
</body>

</html>